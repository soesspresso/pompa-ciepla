<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="dark-theme">
    <header>
        <h1>Welcome to the Dashboard</h1>
        <button id="google-signin">Sign in with Google</button>
        <button id="google-signout">Sign Out</button>
    </header>
    <nav>
        <ul>
            <li><a href="#dashboard">Dashboard</a></li>
            <li><a href="#form">Form</a></li>
            <li><a href="#history">History</a></li>
            <li><a href="#analytics">Analytics</a></li>
        </ul>
    </nav>
    <main>
        <section id="dashboard">
            <h2>Dashboard Overview</h2>
            <!-- Dashboard contents -->
        </section>
        <section id="form">
            <h2>Data Entry Form</h2>
            <form id="data-entry-form">
                <label for="data">Enter Data:</label>
                <input type="text" id="data" name="data" required>
                <button type="submit">Submit</button>
            </form>
        </section>
        <section id="history">
            <h2>History</h2>
            <div id="history-list"></div>
        </section>
        <section id="analytics">
            <h2>Analytics</h2>
            <canvas id="analytics-chart"></canvas>
        </section>
    </main>
    <script src="https://js.supabase.co/v1.0.0/supabase.min.js"></script>
    <script>
        const supabaseUrl = 'https://gmipfhbfvorzpmpwuxfl.supabase.co';
        const supabaseKey = 'your-anon-key'; // Replace with your actual anon key
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);

        let currentUser = null;

        const googleProvider = new firebase.auth.GoogleAuthProvider();
        document.getElementById('google-signin').onclick = async () => {
            const { user, error } = await supabase.auth.signInWithOAuth({ provider: 'google' });
            currentUser = user;
            updateUI();
        };

        document.getElementById('google-signout').onclick = async () => {
            await supabase.auth.signOut();
            currentUser = null;
            updateUI();
        };

        function updateUI() {
            if (currentUser) {
                console.log('User is signed in:', currentUser);
            } else {
                console.log('No user is logged in');
            }
        }

        document.getElementById('data-entry-form').onsubmit = async (e) => {
            e.preventDefault();
            const data = document.getElementById('data').value;
            const { data: entry, error } = await supabase
                .from('entries')
                .insert([{ data }]);
            if (error) {
                console.error('Insert error:', error);
            }
        };

        async function fetchHistory() {
            const { data: entries, error } = await supabase
                .from('entries')
                .select('*');
            if (error) {
                console.error('Fetch error:', error);
            }
            // Logic to display entries in the history section
        }

        async function drawChart() {
            const context = document.getElementById('analytics-chart').getContext('2d');
            // Chart drawing logic using Chart.js or Canvas API
        }

        // RLS checks can be integrated in the Supabase policies
    </script>
</body>
</html>
