<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure App with Google OAuth</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/supabase/1.26.0/supabase.js"></script>
    <script>
        // Your Supabase URL and Key
        const supabaseUrl = 'https://your-supabase-url.supabase.co';
        const supabaseKey = 'your-supabase-key';
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);

        // Google OAuth Configuration
        const { createClient } = supabase;
        const client = createClient(supabaseUrl, supabaseKey);

        function signInWithGoogle() {
            // Sign in with Google OAuth
            const { data, error } = await client.auth.signInWithOAuth({ provider: 'google' });
            if (error) console.error('Error signing in:', error);
        }

        function checkSession() {
            // Check if user is logged in
            const user = supabase.auth.user();
            if (!user) {
                alert('You are not logged in!');
                window.location.href = 'login.html'; // Redirect to login page
            } else {
                console.log('User is logged in:', user);
            }
        }

        async function protectedOperation() {
            checkSession();
            const user = supabase.auth.user();

            // Only allow 'rafal.chylinski@gmail.com' to perform these operations
            if (user.email !== 'rafal.chylinski@gmail.com') {
                alert('You do not have permission to perform this operation.');
                return;
            }

            // Perform insert, update, delete operations
            const { data, error } = await supabase
                .from('your_table')
                .insert([ { field: 'value' } ]);
            if (error) console.error('Error performing operation:', error);
        }

        window.onload = () => {
            checkSession();
            document.getElementById('sign-in-btn').addEventListener('click', signInWithGoogle);
            document.getElementById('protected-operation-btn').addEventListener('click', protectedOperation);
        };
    </script>
</head>
<body>
    <h1>Welcome to the Secure App</h1>
    <button id="sign-in-btn">Sign in with Google</button>
    <button id="protected-operation-btn">Perform Protected Operation</button>
</body>
</html>
